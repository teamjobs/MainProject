<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">


<mapper namespace="review">

<!-- 연봉 -->
	<select id="Income"  resultType="java.util.HashMap" >
		<![CDATA[
		select * from (
  			select rownum rank, temp.* from
    			(select company, avg(pay) average 
      			from income group by company order by average desc) 
  			temp) 
		where company = #{COMPANY}
  		]]>
	</select>
	
	<!-- 면접 난이도 -->
	<select id="InterviewLevel" resultType="java.util.HashMap">
		<![CDATA[
		select * from (
  			select temp.* from
    			(select company, avg(interviewlevel) average 
      			from interview group by company) 
  			temp) 
		where company = #{COMPANY}
		]]>
	</select>
	
	<!-- 면접 경험 -->
	<select id="interAppraisal" resultType="java.util.HashMap">
	
		select  appraisal, count(*) cnt from interview where company = #{company} 
            group by appraisal
     
	</select>
	
	<!-- 면접결과 -->
	<select id="interPass" resultType="java.util.HashMap">

		select  pass, count(*) cnt from interview where company = #{company}
            group by pass 

	</select>
	
	<select id="all" parameterType="java.lang.String" resultType="java.util.HashMap">
		select * from review where company=#{company}
	</select>

	<select id="avg" parameterType="java.lang.String" resultType="java.util.HashMap">
		select avg(WELFARE) aWELFARE,avg(WORKLOAD) aWORKLOAD
		,avg(CULTURE) aCULTURE,
		avg(CHANCE) aCHANCE,
		avg(THINK)aTHINK,avg(RECOMAND)aRECOMAND,avg(FUTURE)aFUTURE from review
	</select>

	<insert id="write" parameterType="java.util.HashMap">
	 	insert into review values(WORK_SEQ.nextval, #{company}, #{type}, #{employment}, #{career}, #{averagescore},#{onereview}, #{positive},
	 							#{negative}, #{welfare}, #{workload}, #{culture}, #{chance}, #{think}, #{recomand}, #{future}, sysdate) 
	</insert>
	
</mapper>
